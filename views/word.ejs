<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" href="./style.css">
  <link rel="stylesheet" href="./basic.css">
  <link rel="stylesheet" href="./word.css">
  <link rel="stylesheet" href="./bottom.css">
  <link rel="stylesheet" href="./searchbox.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>

<body class="word__body">

  <div class="word__box">
    <div class="word__title" data-index="<%= itemIndex %>">
      <%= itemName %>
        <i id="itemIcon" class="bi <% if (isBookmarked) { %>bi-bookmark-fill<% } else { %>bi-bookmark<% } %>"
          onclick="toggleBookmark(this)"></i>
    </div>
    <div class="word__description">
      <div class="word__description--name">뜻</div>
      <div class="word__description--info">
        <%= itemDescription %>
      </div>
    </div>
    <div class="word__line"></div>
    <div class="word__example">
      <div class="word__example--name">예</div>
      <div class="word__example--info">
        <%= itemDescription2 %>
      </div>
    </div>
  </div>

  <nav class="nav_form">
    <i id="itemIcon"
      class="bi <% if (isThumbs) { %>bi bi-hand-thumbs-up-fill<% } else { %>bi bi-hand-thumbs-up<% } %>"
      onclick="togglethumbs(this)" style="font-size: 2rem;"></i>
    <a class="btn__link" href="#"><i class="bi bi-box-arrow-up" style="font-size: 2rem;"></i></a>
  </nav>

  <%- bottom %>

</body>
<script>
  function toggleBookmark(itemIcon) {
    const itemIndex = parseInt(itemIcon.parentElement.getAttribute('data-index'));
    let isBookmarked = itemIcon.classList.contains('bi-bookmark-fill');
    const url = isBookmarked ? `/detail/${itemIndex}/bookmark/delete` : `/detail/${itemIndex}/bookmark`;

    fetch(url, { method: 'POST' })
      .then((response) => {
        if (response.ok) {
          return response.json();
        }
      })
      .then((data) => {
        if (data.hasOwnProperty('isBookmarked')) {
          isBookmarked = data.isBookmarked;
          itemIcon.classList.toggle('bi-bookmark-fill', isBookmarked);
          itemIcon.classList.toggle('bi-bookmark', !isBookmarked);
        }
      })
      .catch((error) => {
        console.error(error);
      });
  }

  function togglethumbs(itemIcon) {
    const itemIndex = parseInt(itemIcon.parentElement.getAttribute('data-index'));
    let isThumbs = itemIcon.classList.contains('bi bi-hand-thumbs-up-fill');
    const url = isThumbs ? `/detail/${itemIndex}/thumbs/delete` : `/detail/${itemIndex}/thumbs`;

    fetch(url, { method: 'POST' })
      .then((response) => {
        if (response.ok) {
          return response.json();
        }
      })
      .then((data) => {
        if (data.hasOwnProperty('isThumbs')) {
          isThumbs = data.isThumbs;
          thumbsIcon.classList.toggle('bi bi-hand-thumbs-up-fill', isThumbs);
          thumbsIcon.classList.toggle('bi bi-hand-thumbs-up', !isThumbs);
        }
      })
      .catch((error) => {
        console.error(error);
      });
  }
</script>


</html>